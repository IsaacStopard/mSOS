(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50659,       1452]
NotebookOptionsPosition[     44070,       1336]
NotebookOutlinePosition[     44462,       1352]
CellTagsIndexPosition[     44419,       1349]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global'*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{3.7981835677098618`*^9, 3.798183632012805*^9, 
  3.876902502513418*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"c982778c-e35e-46f0-b245-62e1b1a2b32c"],

Cell[CellGroupData[{

Cell["Sum of gamma distributions", "Title",
 CellChangeTimes->{{3.7981832961839952`*^9, 3.798183296185536*^9}, {
   3.7981833577182617`*^9, 3.798183401635694*^9}, 
   3.798183507717746*^9},ExpressionUUID->"fa12a761-4d62-4a29-969f-\
dfb46acb7dc9"],

Cell[TextData[StyleBox["Creating custom gamma distribution with the same \
parametrization as R and Stan", "Subsection"]], "Text",
 CellChangeTimes->{{3.798183523550253*^9, 3.7981835634731083`*^9}, {
  3.7981835953501387`*^9, 
  3.7981835980843267`*^9}},ExpressionUUID->"63321b3d-dfa2-4631-82f8-\
3341a55a0a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fCustomGamma", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"GammaDistribution", "[", 
   RowBox[{"a", ",", 
    RowBox[{"1", "/", "b"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.798183514080986*^9, 3.798183515720868*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"43ad280e-f4b5-4fff-8466-bbb0a845078b"],

Cell[TextData[{
 "\n",
 StyleBox["Calculating the mean and variance of the true summed gamma \
distribution", "Subsection"]
}], "Text",
 CellChangeTimes->{{3.7981837536175213`*^9, 
  3.798183806639703*^9}},ExpressionUUID->"3225cdad-ad1f-47e2-91d7-\
d3879b4373c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"aDist", "=", 
   RowBox[{"fCustomGamma", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bDist", "=", 
   RowBox[{"fCustomGamma", "[", 
    RowBox[{"c", ",", "d"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cDist", "=", 
    RowBox[{"TransformedDistribution", "[", 
     RowBox[{
      RowBox[{"u", "+", "v"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[Distributed]", "aDist"}], ",", 
        RowBox[{"v", "\[Distributed]", "bDist"}]}], "}"}]}], "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "cDist", "]"}]}], "Input",
 CellChangeTimes->{
  3.798183517412478*^9, {3.7981837352307997`*^9, 3.798183737541955*^9}, {
   3.798183857430305*^9, 3.798183864582571*^9}, {3.798535877114202*^9, 
   3.798535924220964*^9}, 3.8580536902397823`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"e26f2b7e-1b5f-4622-966b-260367c80fd6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"b", " ", "c"}], "+", 
   RowBox[{"a", " ", "d"}]}], 
  RowBox[{"b", " ", "d"}]]], "Output",
 CellChangeTimes->{3.798535924819137*^9, 3.8580536936609364`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"6977f6e3-1d28-4e79-92f6-15eb8a381e11"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Variance", "[", "cDist", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.798183874776861*^9, 3.798183880873743*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b62e21b3-c560-4ccb-b12c-7f2672e6cf72"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], " ", "c"}], "+", 
   RowBox[{"a", " ", 
    SuperscriptBox["d", "2"]}]}], 
  RowBox[{
   SuperscriptBox["b", "2"], " ", 
   SuperscriptBox["d", "2"]}]]], "Output",
 CellChangeTimes->{3.798183881932383*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"1a15acdc-f52e-4cb5-90e9-30c7a15663c0"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Calculating", " ", "the", " ", 
   StyleBox["shape", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["a", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "nd"}]], " ", 
   StyleBox["rate", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["p", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "arameters"}]], " ", 
   StyleBox["of", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    StyleBox["a", "Subsection",
     FontWeight->"Plain"], "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["g", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "amma"}]], " ", 
   StyleBox["distribution", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["w", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "ith"}]], " ", 
   StyleBox["a", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["g", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "iven"}]], " ", 
   StyleBox["mean", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[" ", "Subsection",
    FontWeight->"Plain"], 
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox["a", "Subsection",
       FontWeight->"Plain"], "Subsection",
      FontWeight->"Plain"], "nd"}]], " ", 
   StyleBox["variance", "Subsection",
    FontWeight->"Plain"], " "}], "Subsection",
  FontWeight->"Plain"]], "Input",
 CellChangeTimes->{
  3.798183887187755*^9, {3.7981839396099777`*^9, 3.7981839621342793`*^9}, {
   3.798184027661242*^9, 
   3.7981840651177883`*^9}},ExpressionUUID->"d6104878-0236-4895-9df9-\
c544d77504d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"fCustomGamma", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.798183847294516*^9, {3.798184074292025*^9, 3.7981840881519547`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2178d57f-9e7a-4c7b-a903-5a684d05e649"],

Cell[BoxData[
 FractionBox["a", "b"]], "Output",
 CellChangeTimes->{3.7981841005288754`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"0dfe584c-4268-4d6c-b08c-4fd6ad974ad5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Variance", "[", 
   RowBox[{"fCustomGamma", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.798184091751877*^9, 3.7981840980733757`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"4a00fc31-489e-4eab-9432-0d1517c0d10c"],

Cell[BoxData[
 FractionBox["a", 
  SuperscriptBox["b", "2"]]], "Output",
 CellChangeTimes->{3.7981841018151493`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"4cf208e7-c799-4e66-9b5d-4b21516dbe27"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Mu]", "==", 
       FractionBox["a", "b"]}], ",", 
      RowBox[{"sigmaSq", "==", 
       FractionBox["a", 
        SuperscriptBox["b", "2"]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7981841068615093`*^9, 3.798184113995604*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"88ee3ff4-04bc-4a6e-a19a-1a30bef2aef9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", 
     FractionBox[
      SuperscriptBox["\[Mu]", "2"], "sigmaSq"]}], ",", 
    RowBox[{"b", "\[Rule]", 
     FractionBox["\[Mu]", "sigmaSq"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7981841199315157`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"d23f083c-f889-47b2-871f-19207a268ee1"]
}, Open  ]],

Cell[TextData[{
 "\nWe therefore approximate the shape and rate parameter of the summed gamma \
distribution by substituting ",
 Cell[BoxData[
  SuperscriptBox["\[Mu]", "2"]],
  CellChangeTimes->{3.7981841199315157`*^9},ExpressionUUID->
  "50b0d193-a643-4a54-8188-3f1cb1d391eb"],
 " and sigmaSq for the mean and variance of the true summed gamma \
distribution (cDist)."
}], "Text",
 CellChangeTimes->{{3.798185174784585*^9, 3.798185225746169*^9}, {
  3.798185257733556*^9, 3.7981852654384823`*^9}, {3.7981853368578243`*^9, 
  3.798185412275679*^9}, {3.798185447195837*^9, 3.79818548352906*^9}, {
  3.798185518846298*^9, 
  3.798185599550264*^9}},ExpressionUUID->"de839000-4b3d-424f-8194-\
c85f34f1bc7a"],

Cell[CellGroupData[{

Cell[TextData[{
 "\n",
 StyleBox[" Oocyst intensity model", "Title"]
}], "Subsection",
 CellChangeTimes->{{3.798184122469605*^9, 3.7981841970614443`*^9}, {
  3.7981853080015182`*^9, 3.798185312344265*^9}, {3.798191161656096*^9, 
  3.798191184619055*^9}},ExpressionUUID->"f0fef107-e3f7-4626-b0ec-\
bba5302dab61"],

Cell["\<\
Specifying a negative binomial distribution with mean and overdispersion \
parameters\
\>", "Text",
 CellChangeTimes->{{3.7981888677166967`*^9, 
  3.798188904203608*^9}},ExpressionUUID->"0efc48e5-f332-4a89-951e-\
386ecf6fcbb9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fCustomNB", "[", 
    RowBox[{"\[Mu]_", ",", "\[Kappa]_"}], "]"}], ":=", 
   RowBox[{"NegativeBinomialDistribution", "[", 
    RowBox[{"\[Kappa]", ",", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Mu]"}]]}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.798188660031466*^9, 3.798188863809229*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"0bd8929e-3133-43e6-a40e-83614bf543c4"],

Cell["\<\

Specifying the zero truncated negative binomial distribution\
\>", "Text",
 CellChangeTimes->{{3.7981889576983957`*^9, 
  3.798189019851802*^9}},ExpressionUUID->"feeb2d9c-3373-4d88-a537-\
6a0e02795506"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tnbDist", "=", 
     RowBox[{"TruncatedDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"fCustomNB", "[", 
        RowBox[{"\[Lambda]", ",", "\[Kappa]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7981889078442497`*^9, 3.798188956825921*^9}, {
  3.7985245321328373`*^9, 3.798524533438315*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"0572cc14-31e4-498f-9224-71bb43f4c0d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Mean", "[", "tnbDist", "]"}]}]], "Input",
 CellChangeTimes->{{3.798524534960561*^9, 3.7985245552774267`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"9f648402-728f-41cc-9aca-5e69c13897ac"],

Cell[BoxData[
 FractionBox["\[Lambda]", 
  RowBox[{"1", "-", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
    "\[Kappa]"]}]]], "Output",
 CellChangeTimes->{3.7985245795757008`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"bfb747e3-c6f5-4b96-a144-8a2ae8f6046e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.798524559653702*^9, 
  3.7985245596565866`*^9}},ExpressionUUID->"e4910a21-629a-4b83-9676-\
8324f3a6591c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Probability density functions\
\>", "Subsection",
 CellChangeTimes->{{3.79819124181581*^9, 
  3.798191254670961*^9}},ExpressionUUID->"048456b0-7c71-44f4-8db0-\
10c11d7553f8"],

Cell["\<\
Mosquitoes with a viable malaria infection have n parasites. We model the \
observed number of parasites as a binomial distribution with x successes \
(observed parasites), n trials (total number of parasites within the \
mosquito, where n follows a zero truncated negative binomial distribution) \
and \[Theta] is the probability a parasite will have developed. We model \
\[Theta] as the CDF of the gamma distributed parasite development times at \
time t. pdf1 gives the probability density function if 1 or more parasites \
are observed, pdf2 gives the probability density function if no parasites are \
observed. \[Delta] is the probability of a viable infection following an \
infectious blood feed..\
\>", "Text",
 CellChangeTimes->{{3.798189101411388*^9, 3.7981891523948298`*^9}, {
   3.798189246292783*^9, 3.7981892663780823`*^9}, {3.7981893428311863`*^9, 
   3.7981893648562326`*^9}, {3.79818939858115*^9, 3.798189405213669*^9}, {
   3.798189469657343*^9, 3.798189484134226*^9}, {3.7981905440794983`*^9, 
   3.798190608246992*^9}, {3.798190646373493*^9, 3.7981906858974333`*^9}, {
   3.7981907778594313`*^9, 3.798190835436571*^9}, {3.7981909854995213`*^9, 
   3.798191034014246*^9}, 
   3.798191256964439*^9},ExpressionUUID->"cc3a20d0-db14-47f9-a81f-\
2c3dee1e7ad8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"btnbDist", "=", 
    RowBox[{"ParameterMixtureDistribution", "[", 
     RowBox[{
      RowBox[{"BinomialDistribution", "[", 
       RowBox[{"n", ",", "\[Theta]"}], "]"}], ",", 
      RowBox[{"n", "\[Distributed]", "tnbDist"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.79818922974654*^9, 3.798189242198833*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b31fdba3-27a9-467a-a60b-53ced328a062"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"pdf1", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", ">", "0"}], ",", 
       RowBox[{"\[Kappa]", ">", "0"}], ",", 
       RowBox[{"0", "<", "\[Theta]", "<", "1"}], ",", 
       RowBox[{"x", "\[GreaterEqual]", "1"}], ",", 
       RowBox[{"x", "\[Element]", "Integers"}]}], "}"}], ",", 
     RowBox[{"PDF", "[", 
      RowBox[{"btnbDist", ",", "x"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.798190692410849*^9, 3.798190719378593*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"dad7403e-236c-459e-b5d3-18e2da9877c8"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Kappa]", "\[Kappa]"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", "\[Lambda]"}], ")"}], "x"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Kappa]", "+", 
      RowBox[{"\[Theta]", " ", "\[Lambda]"}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "x"}], "-", "\[Kappa]"}]], " ", 
   RowBox[{"Binomial", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "x", "+", "\[Kappa]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Kappa]"}]}], "]"}]}], 
  RowBox[{"1", "-", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
    "\[Kappa]"]}]]], "Output",
 CellChangeTimes->{{3.798190721548196*^9, 3.7981907415443287`*^9}, 
   3.858053713092952*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"bb0be48f-0ed2-409f-8cb2-29fba5b4bb07"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"pdf2", "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]", ">", "0"}], ",", 
       RowBox[{"\[Kappa]", ">", "0"}], ",", 
       RowBox[{"0", "<", "\[Theta]", "<", "1"}], ",", 
       RowBox[{"x", "\[Equal]", "0"}], ",", 
       RowBox[{"x", "\[Element]", "Integers"}]}], "}"}], ",", 
     RowBox[{"PDF", "[", 
      RowBox[{"btnbDist", ",", "x"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.798190743072487*^9, 3.7981907701741533`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"ea5018fc-fc8d-4b7c-a981-b730e6cfe7e4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"], "-", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Theta]", " ", "\[Lambda]"}]}]], ")"}], "\[Kappa]"]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
    "\[Kappa]"]}]]], "Output",
 CellChangeTimes->{{3.798190759733794*^9, 3.798190771893902*^9}, 
   3.858053714898739*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"faf5bd99-3c3c-41ab-98d7-0f4547191b9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Mean", "[", "btnbDist", "]"}]}]], "Input",
 CellChangeTimes->{{3.7981908511363907`*^9, 3.798190861902316*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"a46ae389-7e91-4960-a4a9-756f6e016d8c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Theta]", " ", "\[Lambda]"}], 
  RowBox[{"1", "-", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
    "\[Kappa]"]}]]], "Output",
 CellChangeTimes->{3.798190862818997*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"ab605a76-494f-4858-b6ab-81d241493e01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"\[Theta]", " ", "=", " ", 
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"GammaDistribution", "[", 
      RowBox[{"a", ",", " ", 
       RowBox[{"1", "/", "b"}]}], "]"}], ",", " ", "t"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{
  3.798190864493878*^9, {3.7981909259557543`*^9, 3.7981909721737843`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"1f715aa2-e90b-438f-9a1d-9ed718481fd5"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}], 
        RowBox[{"t", ">", "0"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{3.798190972803632*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"483a3cc1-6e95-4956-88a5-1a190cd87582"]
}, Open  ]],

Cell[TextData[StyleBox["Taking into account the probability of viable \
infection following an infectious blood feed. ", "Subsection"]], "Text",
 CellChangeTimes->{{3.798191063113845*^9, 
  3.7981910961008463`*^9}},ExpressionUUID->"4a01f062-ba97-439b-8d14-\
63c74c2930de"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"\[FormalX]", "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Delta]"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"\[Delta]", " ", "*", " ", "pdf2"}], ")"}]}], ",", 
   RowBox[{"(", 
    RowBox[{"\[Delta]", " ", "*", "pdf1"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.79819111140973*^9, 3.7981911468018713`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f4f7c413-9f69-442c-af77-33c7d2b99424"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.798191151096365*^9, 
  3.798191151448699*^9}},ExpressionUUID->"46b2e2da-41b5-43c8-b90c-\
c4daac79b6ff"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parasite prevalence model", "Title",
 CellChangeTimes->{{3.798191206697733*^9, 
  3.798191210427442*^9}},ExpressionUUID->"805deb2e-411b-40d1-9a8b-\
4958105ba350"],

Cell["\<\
We assume the first parasite to develop determines the probability a mosquito \
is determined to be oocyst or sporozoite positive at time t (Pr(O<t)), we \
model the probability the first parasite will have developed by time t as the \
first order distribution.\
\>", "Text",
 CellChangeTimes->{
  3.798191211545165*^9, {3.798192162616065*^9, 3.798192195125833*^9}, {
   3.79819224677666*^9, 3.798192328294601*^9}, {3.798192831370516*^9, 
   3.798192837116334*^9}, {3.798192988843368*^9, 
   3.7981930025079727`*^9}},ExpressionUUID->"66b8a6a8-1553-4a19-82b9-\
9369c09762cc"],

Cell[CellGroupData[{

Cell["\<\
First order distribution  - Pr(O<t) = \[CapitalSigma] Pr(O<t|n) Pr(n) = \
\[CapitalEpsilon](Pr(O<t|n))
CDF\
\>", "Subsection",
 CellChangeTimes->{{3.798192337776087*^9, 3.798192355355218*^9}, {
  3.798192816105431*^9, 3.7981928408234777`*^9}, {3.858055195443568*^9, 
  3.858055196751533*^9}},ExpressionUUID->"6f57f42a-1106-4d90-9688-\
80e6ab569f06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Expectation", "[", 
    RowBox[{
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"GammaRegularized", "[", 
          RowBox[{"a", ",", "0", ",", 
           RowBox[{"t", "*", "b"}]}], "]"}]}], ")"}], "n"]}], ",", 
     RowBox[{"n", "\[Distributed]", "tnbDist"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.798192323415028*^9, 3.7981923238003902`*^9}, {
  3.7981923725940437`*^9, 3.798192373987398*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"50e53dda-c989-4fad-b141-0d27c598f210"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", 
   RowBox[{
    SuperscriptBox["\[Kappa]", "\[Kappa]"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{"-", "\[Kappa]"}]]}]}], 
  RowBox[{"1", "-", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["\[Kappa]", 
      RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
    "\[Kappa]"]}]]], "Output",
 CellChangeTimes->{3.7981923775143557`*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"777f0f3f-6f54-4e48-a77c-d5f9be1a3994"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"Probability", " ", "density", " ", "function"}], 
   "Subsubsection"]}]], "Input",
 CellChangeTimes->{{3.858055163991514*^9, 
  3.85805516485885*^9}},ExpressionUUID->"2fff3025-bdfc-4d1c-a533-\
b2e8fd3aacde"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "[", "t_", "]"}], ":=", 
  FractionBox[
   RowBox[{"1", "-", 
    RowBox[{
     SuperscriptBox["\[Kappa]", "\[Kappa]"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Kappa]", "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"GammaRegularized", "[", 
          RowBox[{"a", ",", "0", ",", 
           RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
      RowBox[{"-", "\[Kappa]"}]]}]}], 
   RowBox[{"1", "-", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["\[Kappa]", 
       RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], 
     "\[Kappa]"]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "'"}], "[", "t", "]"}]}], "Input",
 CellChangeTimes->{
  3.858053677881515*^9, {3.858053821375594*^9, 3.858053826211619*^9}, {
   3.858053859815627*^9, 3.858053922725966*^9}, {3.858054047597445*^9, 
   3.858054079875993*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6848be50-ece3-4fae-83fb-61ad81903767"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "b"}], " ", "t"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"b", " ", "t"}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "a"}]], " ", 
   SuperscriptBox["\[Kappa]", 
    RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Kappa]", "+", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"GammaRegularized", "[", 
        RowBox[{"a", ",", "0", ",", 
         RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["\[Kappa]", 
        RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}], 
   " ", 
   RowBox[{"Gamma", "[", "a", "]"}]}]]], "Output",
 CellChangeTimes->{
  3.876990771422687*^9, {3.877027496067026*^9, 3.877027499641448*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"495cc20d-1285-4ad4-94b4-ec3ef4dff6e7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "t_", "]"}], ":=", 
   FractionBox[
    RowBox[{"b", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "b"}], " ", "t"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"b", " ", "t"}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}]], " ", 
     SuperscriptBox["\[Kappa]", 
      RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Kappa]", "+", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"GammaRegularized", "[", 
          RowBox[{"a", ",", "0", ",", 
           RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["\[Kappa]", 
          RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], 
      ")"}], " ", 
     RowBox[{"Gamma", "[", "a", "]"}]}]]}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{
  3.876990781190332*^9, {3.87702750830236*^9, 3.877027524317959*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"91a3bf48-4726-4f4f-af33-f7e96f373024"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "'"}], "[", "t", "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"80781fcd-f070-457e-98b9-8b6166ea47d4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "b", " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"2", " ", "a"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}], ")"}], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", 
    SuperscriptBox["\[Lambda]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    SuperscriptBox[
     RowBox[{"Gamma", "[", "a", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    RowBox[{"Gamma", "[", "a", "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}]], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    RowBox[{"Gamma", "[", "a", "]"}]}]]}], "\[IndentingNewLine]", 
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", "b", " ", "t"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"b", " ", "t"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "a"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "\[Kappa]"}], ")"}], " ", 
        SuperscriptBox["\[Kappa]", 
         RowBox[{"1", "+", "\[Kappa]"}]], " ", 
        SuperscriptBox["\[Lambda]", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"GammaRegularized", "[", 
             RowBox[{"a", ",", "0", ",", 
              RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "-", "\[Kappa]"}]]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["\[Kappa]", 
             RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], 
         ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Gamma", "[", "a", "]"}], "2"]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "b"}], " ", "t"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"b", " ", "t"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", "a"}]], " ", 
        SuperscriptBox["\[Kappa]", 
         RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"GammaRegularized", "[", 
             RowBox[{"a", ",", "0", ",", 
              RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["\[Kappa]", 
             RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], 
         ")"}], " ", 
        RowBox[{"Gamma", "[", "a", "]"}]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "b"}], " ", "t"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"b", " ", "t"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "a"}]], " ", 
        SuperscriptBox["\[Kappa]", 
         RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", "+", 
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"GammaRegularized", "[", 
             RowBox[{"a", ",", "0", ",", 
              RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["\[Kappa]", 
             RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], 
         ")"}], " ", 
        RowBox[{"Gamma", "[", "a", "]"}]}]]}], "==", "0"}], "&&", 
    RowBox[{"t", ">=", "0"}], "&&", 
    RowBox[{"t", "<=", "Inf"}], " ", "&&", 
    RowBox[{"a", ">=", "0"}], "&&", 
    RowBox[{"a", "<=", "Inf"}], "&&", 
    RowBox[{"b", ">=", "0"}], "&&", 
    RowBox[{"b", "<=", "Inf"}], "&&", 
    RowBox[{"\[Lambda]", ">=", "0"}], "&&", 
    RowBox[{"\[Lambda]", "<=", "Inf"}]}], ",", "t"}], "]"}]}], "Input",
 CellChangeTimes->{{3.877027557610135*^9, 
  3.877027718268553*^9}},ExpressionUUID->"effc9349-0598-41e4-8561-\
dfa85b013c27"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "b", " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"2", " ", "a"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}], ")"}], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", 
    SuperscriptBox["\[Lambda]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    SuperscriptBox[
     RowBox[{"Gamma", "[", "a", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}], ")"}], " ", 
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "2"}], "+", "a"}]], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    RowBox[{"Gamma", "[", "a", "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "b"}], " ", "t"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"b", " ", "t"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "a"}]], " ", 
    SuperscriptBox["\[Kappa]", 
     RowBox[{"1", "+", "\[Kappa]"}]], " ", "\[Lambda]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Kappa]", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"GammaRegularized", "[", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"b", " ", "t"}]}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "\[Kappa]"}]]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Kappa]", 
         RowBox[{"\[Kappa]", "+", "\[Lambda]"}]], ")"}], "\[Kappa]"]}], ")"}],
     " ", 
    RowBox[{"Gamma", "[", "a", "]"}]}]]}]], "Output",
 CellChangeTimes->{3.877027702005046*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"40158736-bab9-424d-a0a7-5d3e680dea78"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Likelihood", "Subsection",
 CellChangeTimes->{{3.798192384755165*^9, 3.798192407161146*^9}, 
   3.858055153679751*^9, {3.858055186949053*^9, 
   3.858055188921623*^9}},ExpressionUUID->"e8bf25d1-353c-426a-82ed-\
c8e284f097e9"],

Cell["\<\
First we model, the number of infected mosquitoes I~B(m, delta), where n is \
sample size and \[Delta] is the probability of viable infection. The number \
of mosquitoes that are parasite-positive is then: X~B(I, Pr(O<t)), which \
gives the binomial distribution X~B(N, Pr(O<t)\[Delta]).\
\>", "Text",
 CellChangeTimes->{{3.798192408803632*^9, 3.798192434940641*^9}, {
   3.7981924893175373`*^9, 3.798192492656794*^9}, {3.798192747213736*^9, 
   3.798192766369879*^9}, {3.7981928921632147`*^9, 3.79819297446937*^9}, {
   3.798193009197261*^9, 3.798193019111106*^9}, {3.798193587505546*^9, 
   3.798193594475759*^9}, {3.798193832096109*^9, 3.7981938353771563`*^9}, 
   3.798194242422517*^9, {3.798202412577887*^9, 
   3.7982024499994583`*^9}},ExpressionUUID->"e4319729-5ec0-40b5-a972-\
c6094948da49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dist", "=", 
   RowBox[{"ParameterMixtureDistribution", "[", 
    RowBox[{
     RowBox[{"BinomialDistribution", "[", 
      RowBox[{"i", ",", "po"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", "\[Distributed]", 
       RowBox[{"BinomialDistribution", "[", 
        RowBox[{"n", ",", "\[Delta]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.798193833713316*^9, 3.798193869336137*^9}, {
  3.798194415162052*^9, 3.798194417133116*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"cef5a5a4-71c7-4ead-b44e-dda16fbeaef3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X", "\[Element]", "Integers"}], ",", 
      RowBox[{"n", ">", "0"}], ",", 
      RowBox[{"X", "\[GreaterEqual]", "0"}], ",", " ", 
      RowBox[{"n", "\[Element]", "Integers"}]}], "}"}], ",", 
    RowBox[{"PDF", "[", 
     RowBox[{"dist", ",", "X"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.798198172513853*^9, 3.798198194629858*^9}, {
  3.7981983228829*^9, 3.798198334731131*^9}, {3.798198914185816*^9, 
  3.798198914386447*^9}, {3.798198988036615*^9, 3.798199001632205*^9}, {
  3.798199849580986*^9, 3.798199862748755*^9}, {3.7981999301729927`*^9, 
  3.7981999313312483`*^9}, {3.7982002029514713`*^9, 3.7982002036636467`*^9}, {
  3.798202467562791*^9, 3.798202475741644*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"ebcdcdbe-0ea4-4bd8-a0f7-9a8340c99f94"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"po", " ", "\[Delta]"}], ")"}], "X"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"po", " ", "\[Delta]"}]}], ")"}], 
          RowBox[{"n", "-", "X"}]], " ", 
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "X"}], "]"}]}], 
        RowBox[{"n", ">", "X"}]},
       {
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"po", " ", "\[Delta]"}], ")"}], "X"], 
        RowBox[{"n", "\[Equal]", "X"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.798198341425973*^9, 3.798198869366189*^9, 3.798199011395154*^9, 
   3.79819936911928*^9, {3.7981998552810097`*^9, 3.798199865462932*^9}, 
   3.7982002072288446`*^9, {3.798202469760709*^9, 3.798202478083619*^9}, 
   3.798208842017*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"196a087b-edae-4fd9-a61e-54d4816c6890"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Survival analysis\
\>", "Title",
 CellChangeTimes->{{3.799478434947331*^9, 
  3.799478469941937*^9}},ExpressionUUID->"48912857-1288-4b07-8390-\
4288f138d305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"HazardFunction", "[", 
   RowBox[{
    RowBox[{"GompertzMakehamDistribution", "[", 
     RowBox[{"b", ",", 
      RowBox[{"a", "/", "b"}]}], "]"}], ",", "t"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.799478471064321*^9, 3.799480897011457*^9, {3.799567585468522*^9, 
   3.7995676152256927`*^9}, {3.79956766104425*^9, 3.799567728913868*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"41d0622a-caac-4f2b-b60e-efd6cfa531fa"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        RowBox[{"a", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"b", " ", "t"}]]}], 
        RowBox[{"t", "\[GreaterEqual]", "0"}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}},
      Selectable->True]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False,
  StripWrapperBoxes->True]], "Output",
 CellChangeTimes->{
  3.799480899797317*^9, {3.799567594002397*^9, 3.7995676159116983`*^9}, {
   3.799567664470292*^9, 3.799567691554624*^9}, 3.7995677295452003`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"a0266a48-01b8-42f6-9e6e-992d64eb8939"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1310, 787},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"44aa82e3-f180-42f7-8c89-72b8791dff0c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 281, 5, 52, "Input",ExpressionUUID->"c982778c-e35e-46f0-b245-62e1b1a2b32c"],
Cell[CellGroupData[{
Cell[864, 29, 246, 4, 98, "Title",ExpressionUUID->"fa12a761-4d62-4a29-969f-dfb46acb7dc9"],
Cell[1113, 35, 311, 5, 41, "Text",ExpressionUUID->"63321b3d-dfa2-4631-82f8-3341a55a0a63"],
Cell[1427, 42, 352, 8, 30, "Input",ExpressionUUID->"43ad280e-f4b5-4fff-8466-bbb0a845078b"],
Cell[1782, 52, 263, 7, 64, "Text",ExpressionUUID->"3225cdad-ad1f-47e2-91d7-d3879b4373c9"],
Cell[CellGroupData[{
Cell[2070, 63, 1002, 25, 115, "Input",ExpressionUUID->"e26f2b7e-1b5f-4622-966b-260367c80fd6"],
Cell[3075, 90, 286, 7, 51, "Output",ExpressionUUID->"6977f6e3-1d28-4e79-92f6-15eb8a381e11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3398, 102, 246, 4, 52, "Input",ExpressionUUID->"b62e21b3-c560-4ccb-b12c-7f2672e6cf72"],
Cell[3647, 108, 365, 11, 55, "Output",ExpressionUUID->"1a15acdc-f52e-4cb5-90e9-30c7a15663c0"]
}, Open  ]],
Cell[4027, 122, 2261, 76, 39, "Input",ExpressionUUID->"d6104878-0236-4895-9df9-c544d77504d8"],
Cell[CellGroupData[{
Cell[6313, 202, 292, 6, 30, "Input",ExpressionUUID->"2178d57f-9e7a-4c7b-a903-5a684d05e649"],
Cell[6608, 210, 171, 3, 48, "Output",ExpressionUUID->"0dfe584c-4268-4d6c-b08c-4fd6ad974ad5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6816, 218, 309, 6, 52, "Input",ExpressionUUID->"4a00fc31-489e-4eab-9432-0d1517c0d10c"],
Cell[7128, 226, 195, 4, 50, "Output",ExpressionUUID->"4cf208e7-c799-4e66-9b5d-4b21516dbe27"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7360, 235, 515, 14, 71, "Input",ExpressionUUID->"88ee3ff4-04bc-4a6e-a19a-1a30bef2aef9"],
Cell[7878, 251, 378, 10, 55, "Output",ExpressionUUID->"d23f083c-f889-47b2-871f-19207a268ee1"]
}, Open  ]],
Cell[8271, 264, 704, 15, 81, "Text",ExpressionUUID->"de839000-4b3d-424f-8194-c85f34f1bc7a"],
Cell[CellGroupData[{
Cell[9000, 283, 311, 7, 116, "Subsection",ExpressionUUID->"f0fef107-e3f7-4626-b0ec-bba5302dab61"],
Cell[9314, 292, 237, 6, 35, "Text",ExpressionUUID->"0efc48e5-f332-4a89-951e-386ecf6fcbb9"],
Cell[9554, 300, 460, 10, 69, "Input",ExpressionUUID->"0bd8929e-3133-43e6-a40e-83614bf543c4"],
Cell[10017, 312, 213, 6, 58, "Text",ExpressionUUID->"feeb2d9c-3373-4d88-a537-6a0e02795506"],
Cell[10233, 320, 579, 14, 73, "Input",ExpressionUUID->"0572cc14-31e4-498f-9224-71bb43f4c0d4"],
Cell[CellGroupData[{
Cell[10837, 338, 246, 4, 52, "Input",ExpressionUUID->"9f648402-728f-41cc-9aca-5e69c13897ac"],
Cell[11086, 344, 337, 9, 62, "Output",ExpressionUUID->"bfb747e3-c6f5-4b96-a144-8a2ae8f6046e"]
}, Open  ]],
Cell[11438, 356, 154, 3, 30, "Input",ExpressionUUID->"e4910a21-629a-4b83-9676-8324f3a6591c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11629, 364, 185, 6, 81, "Subsection",ExpressionUUID->"048456b0-7c71-44f4-8db0-10c11d7553f8"],
Cell[11817, 372, 1286, 20, 104, "Text",ExpressionUUID->"cc3a20d0-db14-47f9-a81f-2c3dee1e7ad8"],
Cell[13106, 394, 471, 11, 52, "Input",ExpressionUUID->"b31fdba3-27a9-467a-a60b-53ced328a062"],
Cell[CellGroupData[{
Cell[13602, 409, 646, 15, 52, "Input",ExpressionUUID->"dad7403e-236c-459e-b5d3-18e2da9877c8"],
Cell[14251, 426, 911, 27, 64, "Output",ExpressionUUID->"bb0be48f-0ed2-409f-8cb2-29fba5b4bb07"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15199, 458, 641, 15, 52, "Input",ExpressionUUID->"ea5018fc-fc8d-4b7c-a981-b730e6cfe7e4"],
Cell[15843, 475, 714, 21, 73, "Output",ExpressionUUID->"faf5bd99-3c3c-41ab-98d7-0f4547191b9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16594, 501, 247, 4, 52, "Input",ExpressionUUID->"a46ae389-7e91-4960-a4a9-756f6e016d8c"],
Cell[16844, 507, 365, 10, 62, "Output",ExpressionUUID->"ab605a76-494f-4858-b6ab-81d241493e01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17246, 522, 446, 11, 52, "Input",ExpressionUUID->"1f715aa2-e90b-438f-9a1d-9ed718481fd5"],
Cell[17695, 535, 1434, 42, 51, "Output",ExpressionUUID->"483a3cc1-6e95-4956-88a5-1a190cd87582"]
}, Open  ]],
Cell[19144, 580, 272, 4, 41, "Text",ExpressionUUID->"4a01f062-ba97-439b-8d14-63c74c2930de"],
Cell[19419, 586, 491, 12, 33, "Input",ExpressionUUID->"f4f7c413-9f69-442c-af77-33c7d2b99424"],
Cell[19913, 600, 152, 3, 30, "Input",ExpressionUUID->"46b2e2da-41b5-43c8-b90c-c4daac79b6ff"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20114, 609, 168, 3, 98, "Title",ExpressionUUID->"805deb2e-411b-40d1-9a8b-4958105ba350"],
Cell[20285, 614, 584, 11, 58, "Text",ExpressionUUID->"66b8a6a8-1553-4a19-82b9-9369c09762cc"],
Cell[CellGroupData[{
Cell[20894, 629, 359, 8, 81, "Subsection",ExpressionUUID->"6f57f42a-1106-4d90-9688-80e6ab569f06"],
Cell[CellGroupData[{
Cell[21278, 641, 642, 16, 54, "Input",ExpressionUUID->"50e53dda-c989-4fad-b141-0d27c598f210"],
Cell[21923, 659, 686, 20, 63, "Output",ExpressionUUID->"777f0f3f-6f54-4e48-a77c-d5f9be1a3994"]
}, Open  ]],
Cell[22624, 682, 278, 7, 54, "Input",ExpressionUUID->"2fff3025-bdfc-4d1c-a533-b2e8fd3aacde"],
Cell[CellGroupData[{
Cell[22927, 693, 976, 27, 86, "Input",ExpressionUUID->"6848be50-ece3-4fae-83fb-61ad81903767"],
Cell[23906, 722, 1094, 33, 66, "Output",ExpressionUUID->"495cc20d-1285-4ad4-94b4-ec3ef4dff6e7"]
}, Open  ]],
Cell[25015, 758, 1244, 37, 89, "Input",ExpressionUUID->"91a3bf48-4726-4f4f-af33-f7e96f373024"],
Cell[26262, 797, 150, 3, 30, "Input",ExpressionUUID->"80781fcd-f070-457e-98b9-8b6166ea47d4"],
Cell[CellGroupData[{
Cell[26437, 804, 7326, 221, 309, InheritFromParent,ExpressionUUID->"effc9349-0598-41e4-8561-dfa85b013c27"],
Cell[33766, 1027, 3302, 105, 125, "Output",ExpressionUUID->"40158736-bab9-424d-a0a7-5d3e680dea78"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37117, 1138, 231, 4, 54, "Subsection",ExpressionUUID->"e8bf25d1-353c-426a-82ed-c8e284f097e9"],
Cell[37351, 1144, 809, 13, 58, "Text",ExpressionUUID->"e4319729-5ec0-40b5-a972-c6094948da49"],
Cell[38163, 1159, 580, 14, 30, "Input",ExpressionUUID->"cef5a5a4-71c7-4ead-b44e-dda16fbeaef3"],
Cell[CellGroupData[{
Cell[38768, 1177, 904, 19, 52, "Input",ExpressionUUID->"ebcdcdbe-0ea4-4bd8-a0f7-9a8340c99f94"],
Cell[39675, 1198, 2069, 60, 73, "Output",ExpressionUUID->"196a087b-edae-4fd9-a61e-54d4816c6890"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41805, 1265, 169, 6, 160, "Title",ExpressionUUID->"48912857-1288-4b07-8390-4288f138d305"],
Cell[CellGroupData[{
Cell[41999, 1275, 482, 11, 52, "Input",ExpressionUUID->"41d0622a-caac-4f2b-b60e-efd6cfa531fa"],
Cell[42484, 1288, 1558, 44, 55, "Output",ExpressionUUID->"a0266a48-01b8-42f6-9e6e-992d64eb8939"]
}, Open  ]]
}, Open  ]]
}
]
*)

